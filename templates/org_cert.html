{% extends "base.html" %}

{% block title %}Certification{% endblock %}

{% block content %}
<div class="main-panel">
    <div class="main-header">
      <div class="main-header-logo">
        <!-- Logo Header -->
        <div class="logo-header" data-background-color="dark">
          <a href="index.html" class="logo">
            <img
              src="static/img/kaiadmin/logo_light.svg"
              alt="navbar brand"
              class="navbar-brand"
              height="20"
            />
          </a>
          <div class="nav-toggle">
            <button class="btn btn-toggle toggle-sidebar">
              <i class="gg-menu-right"></i>
            </button>
            <button class="btn btn-toggle sidenav-toggler">
              <i class="gg-menu-left"></i>
            </button>
          </div>
          <button class="topbar-toggler more">
            <i class="gg-more-vertical-alt"></i>
          </button>
        </div>
        <!-- End Logo Header -->
      </div>
      <!-- Navbar Header -->
      <nav
        class="navbar navbar-header navbar-header-transparent navbar-expand-lg border-bottom"
      >
        <div class="container-fluid">
          <ul class="navbar-nav topbar-nav ms-md-auto align-items-center">
            <li class="nav-item topbar-user dropdown hidden-caret">
                <span class="profile-username">
                  <span class="op-7">Hi,</span>
                  <span class="fw-bold">{{username}}</span>
                </span>
            </li>
          </ul>
        </div>
      </nav>
      <!-- End Navbar -->
    </div>

    <div class="container">
      <div class="page-inner">
        <div class="page-header">
          <h3 class="fw-bold mb-3">Forms</h3>
          <ul class="breadcrumbs mb-3">
            <li class="nav-home">
              <a href="#">
                <i class="icon-home"></i>
              </a>
            </li>
            <li class="separator">
              <i class="icon-arrow-right"></i>
            </li>
            <li class="nav-item">
              <a href="org_cert">Certificate</a>
            </li>
            <li class="separator">
              <i class="icon-arrow-right"></i>
            </li>
            <li class="nav-item">
              <a href="org_cert">Create Certificate</a>
            </li>
          </ul>
        </div>

        
        <form id="certificateForm">
          <div class="row">
            <div class="col-md-1"></div>
            <div class="col-md-12">
              <div class="form-group">
                <label for="walletAddress">Wallet Address: </label>
                <input
                  type="text"
                  class="form-control"
                  id="walletAddress"
                  name="wallet_address"
                />
              </div>
              <div class="form-group">
                <label for="nameContract">Name of the Smart Contract: </label>
                <input
                  type="text"
                  class="form-control"
                  id="nameContract"
                  name="name"
                />
              </div>
              <div class="form-group">
                <label for="ownerWalAddr">Owner Wallet Address: </label>
                <input
                  type="text"
                  class="form-control"
                  id="ownerWalAddr"
                  name="wallet_address_owner"
                />
              </div>
              <div class="form-group">
                <label for="max">Max Supply: </label>
                <input
                  type="number"
                  class="form-control"
                  id="max"
                  name="max_supply"
                  placeholder="Fill 0 for unlimited"
                />
              </div>
              <div class="form-group">
                <label for="certName">Name of Certificate: </label>
                <input
                  type="text"
                  class="form-control"
                  id="certName"
                  name="certificate_name"
                />
              </div>
              <div class="form-group">
                <label for="certSym">Symbol of Certificate: </label>
                <input
                  type="text"
                  class="form-control"
                  id="certSym"
                  name="symbol"
                />
              </div>
              <div class="form-group">
                <label for="exampleFormControlFile1">Example file input</label>
                <input
                  type="file"
                  class="form-control-file"
                  id="exampleFormControlFile1"
                />
              </div>
              <br><br>
            </div>
            <div class="col-md-2"></div>
            <button type="button" class="btn btn-primary" id="submitButton">Submit</button>
          </div>
        </form>
        </div>

      </div>
    </div>


  </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
  document.getElementById('submitButton').addEventListener('click', function() {
    // Collect form data
    const formData = new FormData(document.getElementById('certificateForm'));
    const data = {};
    formData.forEach((value, key) => {
      data[key] = value;
    });
  
    // Make the API request
    fetch('/api/org_create_cert', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'client_id': '9b16ae5638534ae1961fb370f874b6cc',
        'client_secret': 'sk_9b16ae5638534ae1961fb370f874b6cc'
      },
      body: JSON.stringify(data)
    })
    .then(response => response.json())
    .then(data => {
      if (data.result.status === "pending") {
        Swal.fire('Good job!', 'Smart contract created successfully!', 'success');
      } else {
        Swal.fire('Error', data.result.message || 'Failed to create smart contract', 'error');
      }
    })
    .catch(error => {
      Swal.fire('Error', 'An error occurred while creating the smart contract', 'error');
    });
  });
  
</script>


{% endblock %}